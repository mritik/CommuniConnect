<html>
    <head>
        <script src="https://www.gstatic.com/firebasejs/7.6.0/firebase-app.js"></script>
        <script src="https://www.gstatic.com/firebasejs/7.6.0/firebase-analytics.js"></script>
        <script src="https://www.gstatic.com/firebasejs/7.6.0/firebase-auth.js"></script>
        <script src="https://www.gstatic.com/firebasejs/7.6.0/firebase-database.js"></script>
        <script src="https://apis.google.com/js/platform.js" async defer></script>
    </head>

    <body >
            <input type="text" id="studentId" value="Enter Student ID">
            <br>           
            <input type="text" id="name" value="Enter Group Name">
            <input type="text" id="type" value="Enter Group Type">

            <input type="text" id="visibility" value="Enter Group Visibility">
            <br>
            <button onclick = "setData()" >Set Data</button>
            <button onclick = "deleteData()" >Delete data</button>
            <div id='ListGroups'></div>
    </body>
    
    <script>

        var provider = new firebase.auth.EmailAuthProvider();

        var config = 
        {
            apiKey: "AIzaSyDsCfVVy7bHnGaKoVZ_ikwzahwQycMQoMs",
            authDomain: "user-auth-d707b.firebaseapp.com",
            databaseURL: "https://user-auth-d707b-default-rtdb.firebaseio.com",
            projectId: "user-auth-d707b",
            storageBucket: "user-auth-d707b.appspot.com",
            messagingSenderId: "549822857981",
            appId: "1:549822857981:web:7c15df144daf04f6e7b494",
            measurementId: "G-QH58VF587C"
        };

        firebase.initializeApp(config);
        var database = firebase.database();
        var ref = database.ref('GroupInfo');
        ref.once('value', gotData, errData)


        function gotData(data)
        {
            var groupsData = data.val();
            console.log(groupsData);

            if (groupsData != null)
            {
                var keys = Object.keys(groupsData);
                console.log(keys);

                for (var i = 0; i < keys.length; i++)
                {
                    var k = keys[i];
                    var name = groupsData[k].name;
                    var type = groupsData[k].type;
                    var visibility = groupsData[k].visibility;
                    var ListGroups = document.getElementById('ListGroups');
                    var entry = document.createElement('li');
                    entry.appendChild(document.createTextNode(name + " - " + type + " - " + visibility));
                    ListGroups.appendChild(entry);
                }
            }
        }

        function gotData1(data)
        {
            var groupsData = data.val();
            console.log(groupsData);

            if (groupsData != null)
            {
                var name = groupsData.name;
                var type = groupsData.type;
                var visibility = groupsData.visibility;
 
                var ListGroups = document.getElementById('ListGroups');
                var entry = document.createElement('li');
                entry.appendChild(document.createTextNode(name + " - " + type + " - " + visibility));
                ListGroups.appendChild(entry);

            }
        }
        function errData(err)
        {
            console.log('Error!')
            console.log(err)
        }

        function setData() 
        {
            var database = firebase.database();
            var ref = database.ref('GroupInfo');
            
            var sStudentId = parseInt(document.getElementById("studentId").value);
            var sName = document.getElementById("name").value;
            var sType = document.getElementById("type").value;
            var sVisibility = document.getElementById("visibility").value;
            console.log(sStudentId);
            var data = 
            {
                name: sName,
                type: sType,
                visibility: sVisibility
            }
            ref.child(sStudentId).set(data);
            ref = database.ref('GroupInfo/'+ sStudentId);
            ref.once('value', gotData1, errData);
        }

        function deleteData()
        {
            var database = firebase.database();
            dStudentId = parseInt(document.getElementById("studentId").value);

            ref = database.ref('StudentInfo/' + dStudentId);
            ref.set(null);
        }
    </script>
</html>
